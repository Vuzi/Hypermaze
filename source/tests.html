<!DOCTYPE html>
<html>
<head>
	<title>Test !</title>
	<style type="text/css">

		#controls input[type="text"]{
			width: 25px;
		}

	</style>
</head>
<body>
<div id="controls">
	<form>
		From : 
		<input type="text" id="x1" value="1">
		<input type="text" id="y1" value="1">
		To: 
		<input type="text" id="x2" value="42">
		<input type="text" id="y2" value="17"> 

		<input type="submit" value="Dijkstra" id="launch">

		<div id="timer"></div>
	</form>
</div>
<canvas id="canvas" width="1400" height="800"></canvas>

<script type="text/javascript" src="array_utils.js"></script>
<script type="text/javascript" src="ordered_stack.js"></script>
<script type="text/javascript" src="graph.js"></script>
<script type="text/javascript" src="tileset.js"></script>
<script type="text/javascript" src="map.js"></script>
<script type="text/javascript">

	var ctx = document.getElementById('canvas').getContext("2d");

	// Load the tileset
	var t = new Tileset();
	t.onload = function() {

		var m = new Map(ctx, Map.prototype.default_map, t);
		var g = new Graph(m.terrain, true);

		// Draw the background
		m.drawBackground();

		// Launch on the click
		document.getElementById('launch').onclick = function() {
			var y1 = document.getElementById("x1").value;
			var x1 = document.getElementById("y1").value;

			var nodeA = g.getNodeAt(x1,y1);

			var y2 = document.getElementById("x2").value;
			var x2 = document.getElementById("y2").value;

			var nodeB = g.getNodeAt(x2,y2);

			if(nodeA && nodeB) {
				var pawn = new Pawn(1, nodeA);

				setInterval(function() {
					var path = g.dijkstra(pawn.node, nodeB, 0);
					pawn.updatePosition(path);
					
					m.drawBackground();
					g.debugDraw(path, 26);

					// Draw the background & the pawn
					m.drawTileAt(ctx, "P", pawn.node.y, pawn.node.x);
				}, 100);

			} else {
				alert("Error : no node could be selected");
			}

			return false;
		};
	};
	t.load();

</script>

</body>
</html>
