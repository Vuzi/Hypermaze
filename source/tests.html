<!DOCTYPE html>
<html>
<head>
	<title>Test !</title>
	<style type="text/css">

		#controls input[type="text"]{
			width: 25px;
		}

	</style>
</head>
<body>
<div id="controls">
	<form>
		From : 
		<input type="text" id="x1" value="1">
		<input type="text" id="y1" value="1">
		To: 
		<input type="text" id="x2" value="42">
		<input type="text" id="y2" value="17"> 

		<input type="submit" value="Dijkstra" id="launch">

		<div id="timer"></div>
	</form>
</div>
<canvas id="canvas" width="1400" height="800"></canvas>

<script type="text/javascript" src="array_utils.js"></script>
<script type="text/javascript" src="ordered_stack.js"></script>
<script type="text/javascript" src="graph.js"></script>
<script type="text/javascript" src="tileset.js"></script>
<script type="text/javascript" src="map.js"></script>
<script type="text/javascript">

	var ctx = document.getElementById('canvas').getContext("2d");

	var map = new Map(ctx);

    // Create graph
	var g = new Graph(map.terrain, true);

	map.drawBackground();

	var mouse = undefined;

	var step = function() {

		if (mouse == undefined) {
			var y1 = document.getElementById("x1").value;
			var x1 = document.getElementById("y1").value;

			var node = g.getNodeAt(x1,y1);
			mouse = new Pawn(1, node);
		}
		var y2 = document.getElementById("x2").value;
		var x2 = document.getElementById("y2").value;
		var nodeB = g.getNodeAt(x2,y2);

		if(mouse && nodeB) {
			
			var start = new Date().getTime();
			
			var path = g.dijkstra(mouse.node, nodeB, 0);
			
			var time = new Date().getTime() - start;
			
			mouse.updatePosition(path);
			
			document.getElementById('timer').innerHTML = '( in '+time+' ms)';
			map.drawBackground();
			map.drawTileAt(ctx, "P", mouse.node.y, mouse.node.x);

			// g.debugDraw(path, map.tileset.tile_size);

		} else {
			alert("Error : no node could be selected");
		}

		return false;
	};
	setInterval(step, 100);
	// document.getElementById("launch").onclick();

</script>

</body>
</html>
